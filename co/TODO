TBD:



DONE:
 * mutex which used to protect pqueue should be recurive.
